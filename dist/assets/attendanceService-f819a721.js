const d="ems_attendance";function c(){try{return JSON.parse(localStorage.getItem(d))||[]}catch{return[]}}function l(t){try{localStorage.setItem(d,JSON.stringify(t))}catch{}}const s={async listAll(){return{data:c()}},async listByEmployee(t){return{data:c().filter(o=>o.employeeId===t)}},async getTodayLog(t){const o=new Date().toISOString().slice(0,10);return{data:c().find(e=>e.employeeId===t&&e.date===o)||null}},async clockIn({employeeId:t,photoDataUrl:o}){const e=c(),r=new Date().toISOString().slice(0,10);if(e.find(a=>a.employeeId===t&&a.date===r))throw new Error("Already clocked in");const n={id:"a"+Date.now(),employeeId:t,date:r,clockIn:new Date().toISOString(),clockOut:null,photoIn:o,photoOut:null};return e.push(n),l(e),{data:n}},async clockOut({employeeId:t,photoDataUrl:o}){const e=c(),r=new Date().toISOString().slice(0,10),n=e.find(a=>a.employeeId===t&&a.date===r);if(!n)throw new Error("Not clocked in");if(n.clockOut)throw new Error("Already clocked out");return n.clockOut=new Date().toISOString(),n.photoOut=o,l(e),{data:n}}};export{s as a};
